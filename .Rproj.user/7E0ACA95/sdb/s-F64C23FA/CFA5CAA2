{
    "contents" : "#' Function to calculate ancestral values at particular snapshots in evolutionary time\n#'\n#' This function calculates ancestral values at a particular snapshot in evolutionare time\n#' @param X ieObject\n#' @return dataframe with rates for all branches and ancestral states for all nodes in the tree up to the indicated epoch\n#' @export\nMorphoSpaceEpoch<-function(X,Mya){\n\n#Mya<-90\n\n#Which branches fall onto the Mya line?\nvalue_epoch_all<-c()\nMorphoSpace_epoch<-X[which((X$time_node_anc>Mya)&((X$time_node_anc-X$BL)<=(Mya+.00000000001))),]\ndata_epoch<-split(MorphoSpace_epoch,1:nrow(MorphoSpace_epoch))\n\n#Calculate ancestral state at the Mya line\nfor (i in 1:length(data_epoch)){\n\nchangePerUnit<-(data_epoch[[i]]$value_desc-data_epoch[[i]]$value_anc)/data_epoch[[i]]$BL\ntimeleft<-data_epoch[[i]]$BL-(Mya-(data_epoch[[i]]$time_node_anc-data_epoch[[i]]$BL))\nvalue_epoch<-data_epoch[[i]]$value_anc+(changePerUnit*timeleft)\nvalue_epoch_all<-rbind(value_epoch_all,value_epoch)\n\n                                }\nMorphoSpace_epoch<-cbind(MorphoSpace_epoch,value_epoch_all)\n            return(MorphoSpace_epoch)\n\n                                }\n",
    "created" : 1423075670531.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1341420285",
    "id" : "CFA5CAA2",
    "lastKnownWriteTime" : 1423007339,
    "path" : "~/Google Drive/Research Projects/CURRENT_Smaers R Package/Evomap_Github/R/MorphospaceEpoch.r",
    "project_path" : "R/MorphospaceEpoch.r",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}